# Road Marking Recognition Project
## Сравнение комбинированных методов для распознавания дорожной разметки

### Introduction

Область компьютерного зрения представляет собой область науки, посвящённую извлечению и обработке структурированной информации из неструктурированной окружающей среды. 

>Оставляя пафосные фразы позади - нужно научить компьютер видеть как человек с идеальным зрением, а ещё лучше, если система будет представлять собой человека с идеальным зрением, смотрящего в бинокль. 

Далее, рассматривается проблема распознавания линий дорожной разметки. Входные данные были получены в ходе участия во Всероссийских соревнованиях AutoNet18+ в рамках фестиваля ProFest 2018. Для обработки изображений использовались стандартные возможности библиотеки OpenCV и Python 2.7.12.

### Road Lane Segmentation Neural Network Description

Нейронная сеть для сегментации разметки на дороге реализована на основе архитектуры [MobileNetV2](https://arxiv.org/abs/1801.04381) для реализации кодирования изображения, которая имеет ряд модификаций для работы на вычислительной платформе Intel Neural Compute Stick (Movidius). Дальнейшие вычисления сети основаны на принципах архитектуры [Unet](https://arxiv.org/abs/1809.10486), в которой ветка расширения и преобразования закодированного изображения производится расширением (Deconvolution) с добавлением признаков из слоев ветки кодирования.
Сокращенное представление нейронной сети описано в таблице 1. 

<p align="right">
  <a>Таблица 1 - Сокращённое представление нейронной сети</a>
</p>

| №  | Размер входа | Название слоя | Повторение слоём (n) |     Комментарии к слою       |
|:-: | :----------: | :-----------: | :------------------: | :--------------------------: |
| 0  |   320x160x3  |     input     |           1          |        Входной слой          |
| 1  |   160x80x32  |  bottleneck   |           1          |                              |
| 2  |   160x80x16  |  bottleneck   |           2          |                              |
| 3  |    80x40x24  |  bottleneck   |           3          |                              |
| 4  |    40x20x32  |  bottleneck   |           4          |                              |
| 5  |    20x10x64  |  bottleneck   |           3          |                              |
| 6  |    20x10x96  |  bottleneck   |           3          |                              | 
| 7  |    10x5x160  |  bottleneck   |           1          |                              |
| 8  |    10x5x320  |    deconv     |           1          |                              |
| 9  |    20x10x64  |    add(4)     |           1          |Суммирование входа со слоём 4 |
| 10 |    20x10x64  |  bottleneck   |           1          |                              |
| 11 |    20x10x64  |    deconv     |           1          |                              |
| 12 |    40x20x32  |    add(3)     |           1          |Суммирование входа со слоём 3 |
| 13 |    40x20x32  |  bottleneck   |           1          |                              |
| 14 |    40x20x32  |    deconv     |           1          |                              |
| 15 |    80x40x24  |    add(2)     |           1          |Суммирование входа со слоём 2 |
| 16 |    80x40x24  |  bottleneck   |           1          |                              |
| 17 |    80x40x24  |    deconv     |           1          |                              |
| 18 |   160x80x16  |    deconv     |           1          |                              |
| 19 |   320x160x8  |  convolution  |           1          |Точечная свёртка с ядром (1,1)|
| 20 |   320x160x1  |    sigmoid    |           1          |Выходной слой                 |

* Слой **“bottleneck”** описан в данной [работе](https://arxiv.org/abs/1801.04381).
* Слой **“deconv”** является стандартно используемым слоем, который позволяет увеличить размерность входной матрицы.
* Слои **“input”**, **“add”**, **“convolution”** и **“sigmoid”** являются также стандартными операциями над передаваемыми данными. 
Представленные  в таблице данные являются исходными, так как в сети был использован гиперпараметр альфа со значением 0.5, и используется для равномерного понижения размерности каналов слоев сети с целью увеличения быстродействия.

В результате использования нейронной сети на платформе Movidius была получена скорость обработки кадров примерно 26 FPS.

За уточнениями по данной магии обращаться к [KaiL4eK](https://github.com/KaiL4eK) :bowtie:

### Simple Road Lane Detection

